<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic Electronics - Exam System</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&family=Sarabun:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    
    <style>
        body { font-family: 'Sarabun', 'Inter', sans-serif; background-color: #f0f9ff; overflow-x: hidden; }
        .page { display: none; }
        
        .float-up { animation: floatUp 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards; opacity: 0; transform: translateY(50px); }
        .delay-1 { animation-delay: 0.2s; } .delay-2 { animation-delay: 0.4s; }
        @keyframes floatUp { to { opacity: 1; transform: translateY(0); } }
        .floating-bg { position: absolute; animation: floatHover 6s ease-in-out infinite; }
        @keyframes floatHover { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

        .cell-doing { background-color: #fbbf24; color: white; }
        .cell-done { background-color: #cbd5e1; color: white; }
        .cell-correct { background-color: #22c55e; color: white; }
        .cell-wrong { background-color: #ef4444; color: white; }
        
        #loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.98); z-index: 9999;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            text-align: center; padding: 20px;
        }
        .spinner { border: 4px solid #e0f2fe; border-top: 4px solid #0284c7; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        #message-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6); z-index: 10000;
            display: none; justify-content: center; align-items: center;
        }

        .bar-fill { transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
        .clickable-header { cursor: pointer; transition: all 0.2s; }
        .clickable-header:hover { background-color: #bae6fd !important; color: #0284c7; transform: scale(1.05); }
        
        /* Fireworks/Confetti styles */
        .confetti { position: absolute; top: -50px; width: 12px; height: 12px; border-radius: 50%; opacity: 0; pointer-events: none; }
        @keyframes confettiFall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
    </style>
</head>
<body class="text-gray-800 relative">

    <div id="app" class="w-full min-h-screen flex flex-col relative z-10">

        <!-- Loading Overlay -->
        <div id="loading-overlay">
            <div class="spinner mb-6"></div>
            <h2 class="text-sky-700 font-bold text-2xl mb-2">Basic Electronics</h2>
            <div id="loading-log" class="text-sm text-gray-500 mb-6 font-mono h-6">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö...</div>
            
            <div id="diagnostic-box" class="hidden bg-amber-50 border border-amber-200 text-amber-700 p-4 rounded-xl text-sm max-w-md mb-4 text-left">
                <p class="font-bold mb-1"><i class="fa-solid fa-circle-exclamation mr-2"></i>‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤:</p>
                <p id="diagnostic-text" class="font-mono text-xs break-words">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            </div>

            <button id="btn-force-reset" onclick="forceReset()" class="bg-red-500 text-white px-6 py-3 rounded-lg hover:bg-red-600 transition font-bold shadow-lg text-sm flex items-center gap-2 mt-4">
                <i class="fa-solid fa-rotate-right"></i> ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á Cache
            </button>
            <p class="text-xs text-gray-300 mt-8 absolute bottom-4">v11.0 Master Edition</p>
        </div>
        
        <!-- Modal -->
        <div id="message-modal">
            <div class="bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md text-center mx-4 transform scale-100 transition-transform">
                <div id="modal-icon" class="text-5xl mb-4">‚ö†Ô∏è</div>
                <h3 id="modal-title" class="text-xl font-bold mb-2 text-gray-800">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
                <p id="modal-message" class="text-gray-600 mb-6 text-sm"></p>
                <button id="modal-close-btn" class="w-full bg-sky-600 text-white px-4 py-3 rounded-xl hover:bg-sky-700 transition font-bold shadow-lg">‡∏ï‡∏Å‡∏•‡∏á</button>
            </div>
        </div>

        <!-- 1. Landing Page -->
        <div id="page-home" class="page w-full min-h-screen relative overflow-hidden bg-gradient-to-br from-sky-100 via-white to-blue-50 flex items-center justify-center" style="display: flex;">
            <i class="fa-solid fa-microchip text-blue-100 text-9xl absolute bottom-20 right-10 floating-bg" style="animation-delay: 1s;"></i>
            <i class="fa-solid fa-bolt text-yellow-100 text-8xl absolute top-40 left-40 floating-bg opacity-50" style="animation-delay: 2s;"></i>
            
            <div class="relative z-20 text-center max-w-4xl mx-auto px-4">
                <div class="float-up mb-8">
                    <div class="inline-flex items-center gap-3 bg-white px-6 py-3 rounded-full shadow-md border border-sky-100">
                        <i class="fa-solid fa-industry text-sky-600 text-3xl"></i>
                        <span class="text-2xl font-extrabold tracking-widest text-gray-800">Electronics Dept.</span>
                    </div>
                </div>
                <div class="text-center pb-4 float-up delay-1">
                    <h1 class="text-5xl md:text-7xl font-black text-sky-800 drop-shadow-sm tracking-tighter">Basic Electronics</h1>
                    <h2 class="text-xl md:text-3xl font-bold text-sky-600 mt-2">Component Testing</h2>
                </div>
                <div class="flex flex-col sm:flex-row gap-6 justify-center items-center float-up delay-2 mt-8">
                    <button id="btn-go-teacher" class="group relative bg-white text-sky-700 px-10 py-4 rounded-full font-bold text-xl shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 border-2 border-sky-100 overflow-hidden">
                        <span class="relative z-10"><i class="fa-solid fa-chalkboard-user mr-2"></i> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏π</span>
                    </button>
                    <button id="btn-go-student" class="group relative bg-sky-600 text-white px-10 py-4 rounded-full font-bold text-xl shadow-lg hover:shadow-xl hover:bg-sky-700 transition-all transform hover:-translate-y-1 border-2 border-transparent">
                        <span class="relative z-10"><i class="fa-solid fa-user-graduate mr-2"></i> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- 2. Teacher Dashboard -->
        <div id="page-teacher-dashboard" class="page w-full max-w-[95%] mx-auto pt-6 px-4 pb-12" style="display: none;">
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-sky-100 flex flex-wrap justify-between items-center gap-4 mb-6">
                <div class="flex items-center gap-4">
                    <div class="bg-sky-100 p-3 rounded-xl text-sky-600"><i class="fa-solid fa-chart-pie text-2xl"></i></div>
                    <div><h2 class="text-2xl font-bold text-slate-800">Monitor Room by Thanat Yodwong</h2><p class="text-slate-500 text-sm">‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≠‡∏ö: <span id="student-count" class="font-bold text-sky-600">0</span> ‡∏Ñ‡∏ô</p></div>
                </div>
                <div class="flex gap-3">
                     <button id="btn-toggle-system" class="px-6 py-2.5 rounded-xl text-white font-bold shadow-md transition bg-gray-400 hover:bg-gray-500 flex items-center gap-2">
                        <i class="fa-solid fa-power-off"></i> <span id="txt-system-status">Loading...</span>
                    </button>
                    <button onclick="window.location.reload()" class="px-4 py-2.5 rounded-xl bg-slate-100 hover:bg-slate-200 text-slate-600 font-bold transition"><i class="fa-solid fa-sign-out-alt"></i></button>
                </div>
            </div>

            <!-- New Order: Top 5 Leaderboard (Full Width at Top) -->
            <div class="bg-gradient-to-br from-blue-600 to-sky-500 rounded-2xl shadow-lg p-6 text-white mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-bold flex items-center gap-2"><i class="fa-solid fa-trophy text-yellow-300 animate-bounce"></i> Top 5 Leaderboard</h3>
                    <div class="flex gap-4 text-xs font-bold bg-white/20 px-4 py-1.5 rounded-full">
                        <span><i class="fa-solid fa-users mr-1"></i> Ranking</span>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4" id="leaderboard-list">
                    <div class="text-center opacity-70 py-4 col-span-5">‡∏£‡∏≠‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô...</div>
                </div>
            </div>

            <div class="space-y-6">
                <!-- Controls Row -->
                <div class="bg-white rounded-2xl shadow-sm border border-sky-100 p-4 flex flex-wrap items-center justify-between gap-4">
                    <div class="flex gap-6">
                        <label class="flex items-center gap-2 cursor-pointer group">
                            <input type="checkbox" id="toggle-names" class="w-5 h-5 accent-sky-600" checked>
                            <span class="text-slate-600 font-bold text-sm group-hover:text-sky-600 transition">‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer group">
                            <input type="checkbox" id="toggle-answers" class="w-5 h-5 accent-green-500">
                            <span class="text-slate-600 font-bold text-sm group-hover:text-sky-600 transition">‡πÄ‡∏â‡∏•‡∏¢ (‡∏ñ‡∏π‡∏Å/‡∏ú‡∏¥‡∏î)</span>
                        </label>
                    </div>
                    <div class="flex gap-3">
                        <button id="btn-dl-excel" class="bg-emerald-500 text-white px-6 py-2 rounded-lg hover:bg-emerald-600 transition font-bold text-sm shadow-md"><i class="fa-solid fa-file-excel mr-2"></i> Export Excel</button>
                        <button id="btn-clear-db" class="bg-red-50 text-red-500 px-6 py-2 rounded-lg hover:bg-red-100 transition font-bold text-sm"><i class="fa-solid fa-trash mr-2"></i> ‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö</button>
                    </div>
                </div>

                <!-- Main Table (Scrollable Horizontal) -->
                <div class="bg-white rounded-2xl shadow-sm border border-sky-100 flex flex-col overflow-hidden h-[600px]">
                    <div class="p-4 border-b border-slate-100 bg-slate-50 font-bold text-slate-600 flex justify-between items-center">
                        <span>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° <span class="text-xs font-normal text-slate-400 ml-2">(‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏Ç‡∏Ç‡πâ‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)</span></span>
                        <span class="text-xs font-normal text-slate-400">Auto-update</span>
                    </div>
                    <div class="flex-1 overflow-auto">
                        <table class="w-full text-left border-collapse min-w-[2000px]"> <!-- Set min-width to ensure no wrapping -->
                            <thead class="bg-white sticky top-0 z-10 text-xs uppercase text-slate-500 shadow-sm">
                                <tr id="grid-header-row"></tr>
                            </thead>
                            <tbody id="grid-body" class="text-sm divide-y divide-slate-50"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 7. Question Detail Page -->
        <div id="page-question-detail" class="page w-full max-w-7xl mx-auto pt-6 px-4 pb-12" style="display: none;">
            <div class="flex flex-col lg:flex-row gap-6">
                <div class="lg:w-2/3 bg-white p-8 rounded-2xl shadow-xl border border-slate-100">
                    <div class="flex items-center justify-between mb-8 border-b border-slate-100 pb-4">
                        <button id="btn-back-dashboard" class="text-slate-500 hover:text-sky-600 font-bold flex items-center gap-2 transition px-3 py-2 rounded-lg hover:bg-sky-50">
                            <i class="fa-solid fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö
                        </button>
                        <div class="text-center">
                            <span class="block text-xs text-slate-400 font-bold uppercase tracking-wider">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà</span>
                            <span class="text-3xl font-black text-sky-600" id="detail-q-num">1</span>
                            <span class="text-slate-400 font-medium">/ 40</span>
                        </div>
                        <div class="flex gap-2">
                            <button id="btn-prev-q" class="w-10 h-10 flex items-center justify-center bg-slate-100 rounded-full hover:bg-sky-100 hover:text-sky-600 transition"><i class="fa-solid fa-chevron-left"></i></button>
                            <button id="btn-next-q" class="w-10 h-10 flex items-center justify-center bg-slate-100 rounded-full hover:bg-sky-100 hover:text-sky-600 transition"><i class="fa-solid fa-chevron-right"></i></button>
                        </div>
                    </div>

                    <div class="mb-10 text-center">
                        <h2 class="text-2xl font-bold text-slate-800 mb-6 leading-relaxed" id="detail-q-text">...</h2>
                        <div id="detail-q-image" class="hidden mb-6 flex justify-center">
                            <img src="" id="detail-img-tag" alt="Question Image" class="max-h-72 rounded-xl shadow-lg border-4 border-slate-50">
                        </div>
                    </div>

                    <div class="flex justify-center">
                        <button id="btn-toggle-detail-results" class="bg-sky-600 text-white px-10 py-3 rounded-full font-bold shadow-lg hover:bg-sky-700 transition transform hover:scale-105 flex items-center gap-3">
                            <i class="fa-solid fa-chart-simple"></i> <span id="txt-detail-btn">‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</span>
                        </button>
                    </div>
                </div>

                <div class="lg:w-1/3 space-y-6">
                    <div class="bg-slate-800 text-white p-6 rounded-2xl shadow-lg relative overflow-hidden">
                        <div class="relative z-10">
                            <div class="text-slate-400 text-sm font-bold uppercase mb-1">‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å</div>
                            <div class="text-4xl font-black text-green-400"><span id="detail-correct-count">0</span> <span class="text-lg text-slate-400 font-medium">‡∏Ñ‡∏ô</span></div>
                            <div class="mt-4 pt-4 border-t border-slate-700 flex justify-between items-center">
                                <span class="text-sm text-slate-400">‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö</span>
                                <span class="text-xl font-bold"><span id="detail-total-responses">0</span> ‡∏Ñ‡∏ô</span>
                            </div>
                        </div>
                        <i class="fa-solid fa-chart-pie absolute -bottom-6 -right-6 text-9xl text-slate-700 opacity-20"></i>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="font-bold text-slate-700 mb-4">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</h3>
                        <div id="detail-results-container" class="space-y-3 transition-all duration-500"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. Student Login -->
        <div id="page-student-login" class="page m-auto bg-white p-8 rounded-2xl shadow-xl max-w-md w-full mt-10 border border-sky-50">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 text-green-600 text-3xl shadow-inner"><i class="fa-solid fa-user-graduate"></i></div>
                <h2 class="text-2xl font-bold text-slate-800">‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö</h2>
                <p class="text-slate-400 text-sm">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</p>
            </div>
            <div class="space-y-5">
                <input type="text" id="student-id" class="w-full px-4 py-3.5 border-2 border-slate-100 rounded-xl focus:ring-4 focus:ring-green-100 focus:border-green-500 outline-none text-center text-xl font-bold tracking-widest transition" placeholder="ID Code">
                <div id="student-preview" class="hidden bg-green-50 p-4 rounded-xl text-center border border-green-100 animate-fade-in"><p class="font-bold text-green-800 text-lg" id="preview-name"></p><p class="text-sm text-green-600" id="preview-dept"></p></div>
                <button id="btn-student-login" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white px-4 py-4 rounded-xl font-bold text-lg hover:shadow-lg hover:scale-[1.02] transition transform">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö <i class="fa-solid fa-arrow-right ml-2"></i></button>
                <button onclick="location.reload()" class="w-full text-slate-400 text-sm hover:text-slate-600 mt-2">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
        </div>

        <!-- 4. Student Exam -->
        <div id="page-student-exam" class="page m-auto bg-white w-full max-w-3xl rounded-2xl shadow-2xl overflow-hidden mt-4 flex-col h-[85vh] border border-slate-200">
            <div class="bg-white p-5 border-b border-slate-100 flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-sky-100 text-sky-600 flex items-center justify-center font-bold"><i class="fa-regular fa-user"></i></div>
                    <div><h2 class="font-bold text-slate-800 text-sm" id="exam-student-name">Name</h2><p class="text-xs text-slate-500" id="exam-student-dept">Dept</p></div>
                </div>
                <div class="text-right"><span class="text-3xl font-black text-sky-600" id="q-current">1</span><span class="text-sm text-slate-400 font-medium text-gray-400">/ 40</span></div>
            </div>
            <div class="w-full bg-slate-100 h-1.5"><div id="progress-bar" class="bg-sky-500 h-1.5 transition-all duration-500" style="width: 0%"></div></div>
            <div class="flex-1 p-6 md:p-10 overflow-y-auto flex flex-col justify-center bg-slate-50">
                <div id="question-card" class="bg-white p-8 rounded-2xl shadow-sm border border-slate-100 animate-fade-in">
                    <span class="inline-block px-3 py-1 rounded-md bg-sky-100 text-sky-700 text-xs font-bold mb-4 tracking-wider">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</span>
                    <h3 class="text-xl md:text-2xl font-medium text-slate-800 mb-6 leading-relaxed" id="question-text">...</h3>
                    <div id="question-image-container" class="mb-6 hidden flex justify-center">
                        <img id="question-image" src="" alt="Component" class="max-h-60 rounded-lg shadow-md border border-gray-200">
                    </div>
                    <div id="options-container" class="space-y-4"></div>
                </div>
            </div>
            <div class="p-5 bg-white border-t border-slate-100 flex justify-between items-center">
                <button id="btn-prev" class="px-6 py-3 rounded-xl font-bold text-slate-500 hover:bg-slate-100 disabled:opacity-30 disabled:cursor-not-allowed transition flex items-center gap-2" disabled><i class="fa-solid fa-arrow-left"></i> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
                <button id="btn-next" class="px-8 py-3 rounded-xl font-bold bg-sky-600 text-white hover:bg-sky-700 shadow-lg hover:shadow-sky-200 transition flex items-center gap-2">‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <i class="fa-solid fa-arrow-right"></i></button>
                <button id="btn-submit" class="hidden px-8 py-3 rounded-xl font-bold bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg hover:shadow-green-200 transition transform hover:scale-105 flex items-center gap-2">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö <i class="fa-solid fa-check-circle"></i></button>
            </div>
        </div>

        <!-- 5. Submitted -->
        <div id="page-submitted" class="page m-auto bg-white p-12 rounded-3xl shadow-2xl text-center max-w-lg mt-10 border-4 border-green-50 relative overflow-hidden">
            <div id="confetti-container" class="absolute inset-0 pointer-events-none z-50"></div>
            <div class="relative z-10">
                <div id="submit-emoji" class="mb-6 text-8xl animate-bounce">üéâ</div>
                <h2 id="submit-title" class="text-3xl font-black text-slate-800 mb-2">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!</h2>
                <p id="submit-message" class="text-slate-500 text-lg mb-8">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</p>
                <button onclick="location.reload()" class="bg-slate-100 text-slate-600 px-8 py-3 rounded-full font-bold hover:bg-slate-200 transition">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
            </div>
        </div>

        <!-- 6. Teacher Login -->
        <div id="page-teacher-login" class="page bg-white p-8 rounded-2xl shadow-lg max-w-md mx-auto mt-10">
            <h2 class="text-2xl font-bold text-center text-sky-700 mb-6">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏π</h2>
            <div class="space-y-4">
                <input type="password" id="teacher-room-code" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-sky-500 outline-none" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á...">
                <button id="btn-teacher-login" class="w-full bg-sky-600 text-white px-4 py-2 rounded-md font-semibold hover:bg-sky-700 transition shadow-sm">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
                <button onclick="location.reload()" class="w-full text-center text-gray-600 hover:text-sky-600 transition mt-2">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { initializeFirestore, doc, getDoc, setDoc, updateDoc, onSnapshot, collection, query, writeBatch, getDocs, CACHE_SIZE_UNLIMITED } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyCr08U5KYGvxXu-DZ5qZOyVnU_1MJ-oY50",
            authDomain: "rba-online-6342e.firebaseapp.com",
            databaseURL: "https://rba-online-6342e-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "rba-online-6342e",
            storageBucket: "rba-online-6342e.firebasestorage.app",
            messagingSenderId: "50383344070",
            appId: "1:50383344070:web:5003afe4c5530fc1d5a2c7",
            measurementId: "G-G75D8551FP"
        };

        const SHEET_URL = "https://docs.google.com/spreadsheets/d/163RszY_6sDDQXxWiPlkw7g5HCj_U4N49H7CMCmzWPEw/export?format=csv&gid=0";
        const TEACHER_CODE = "basic";
        
        const MASTER_QUESTIONS = [
            { t: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÉ‡∏ô‡∏ß‡∏á‡∏à‡∏£ ‡∏Ñ‡∏∑‡∏≠", opts: ["‡∏Ç‡∏î‡∏•‡∏ß‡∏î", "‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏", "‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô", "‡∏´‡∏°‡πâ‡∏≠‡πÅ‡∏õ‡∏•‡∏á"], a: 2 }, 
            { t: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ö‡πÅ‡∏´‡∏•‡πà‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÉ‡∏ô‡∏ß‡∏á‡∏à‡∏£ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Å‡πá‡∏ö ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ñ‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡πÑ‡∏î‡πâ", opts: ["‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô", "‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏", "‡∏ï‡∏±‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏ô‡∏≥", "‡∏´‡∏°‡πâ‡∏≠‡πÅ‡∏õ‡∏•‡∏á"], a: 1 }, 
            { t: "‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô ‡∏°‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏Ñ‡∏∑‡∏≠", opts: ["‡πÇ‡∏≠‡∏´‡πå‡∏°", "‡πÇ‡∏ß‡∏•‡∏ï‡πå", "‡πÄ‡∏Æ‡∏ô‡∏£‡∏µ‡πà", "‡πÅ‡∏≠‡∏°‡πÅ‡∏õ‡∏£‡πå"], a: 0 }, 
            { t: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏™‡∏≤‡∏£‡∏Å‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏ô‡∏≥", opts: ["‡∏ï‡∏±‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏ô‡∏≥", "‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡∏ä‡∏ô‡∏¥‡∏î‡πÑ‡∏°‡∏Å‡πâ‡∏≤", "‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå", "‡∏´‡∏°‡πâ‡∏≠‡πÅ‡∏õ‡∏•‡∏á"], a: 2 }, 
            { t: "‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏ ‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏¢‡πà‡∏≠‡πÉ‡∏ô Build Sheet (B/S) ‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£", opts: ["D", "IC", "C", "Q"], a: 2 }, 
            { t: "‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô ‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏¢‡πà‡∏≠‡πÉ‡∏ô Build Sheet (B/S) ‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£", opts: ["R", "C", "L", "T"], a: 0 }, 
            { t: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ç‡πâ‡∏≠‡πÉ‡∏î ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡πÅ‡∏ö‡∏ö SMD ‡∏°‡∏µ‡πÅ‡∏ñ‡∏ö‡∏™‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡πà‡∏á‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏±‡πâ‡∏ß‡∏ö‡∏ß‡∏Å ( + )", opts: ["‡πÄ‡∏ã‡∏£‡∏≤‡∏°‡∏¥‡∏Å ‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏Ø", "‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Ñ‡πÇ‡∏ó‡∏£‡πÑ‡∏•‡∏ï‡∏¥‡∏Å ‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏Ø", "‡∏ä‡∏¥‡∏ö‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå", "‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏•‡∏±‡∏° ‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏Ø"], a: 3 }, 
            { t: "‡∏ï‡∏±‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏ô‡∏≥‡∏°‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î ‡∏Ñ‡∏∑‡∏≠", opts: ["‡πÇ‡∏≠‡∏´‡πå‡∏°", "‡πÄ‡∏Æ‡∏ô‡∏£‡∏µ‡πà", "‡πÇ‡∏ß‡∏•‡∏ï‡πå", "‡πÅ‡∏≠‡∏°‡πÅ‡∏õ‡∏£‡πå"], a: 1 }, 
            { t: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≤‡∏£‡∏Å‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏ß‡∏á‡∏à‡∏£‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏ô‡∏¥‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ä‡∏¥‡∏ö (Chip) ‡∏™‡∏≤‡∏£‡∏Å‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏Å ‡∏Ñ‡∏∑‡∏≠", opts: ["‡πÑ‡∏î‡πÇ‡∏≠‡∏î", "‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå", "‡πÑ‡∏ó‡∏£‡∏¥‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå", "‡∏ß‡∏á‡∏à‡∏£‡∏£‡∏ß‡∏° (IC)"], a: 3 }, 
            { t: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡πÅ‡∏£‡∏á‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏™‡∏•‡∏±‡∏ö ‡∏Ñ‡∏∑‡∏≠", opts: ["‡∏´‡∏°‡πâ‡∏≠‡πÅ‡∏õ‡∏•‡∏á", "‡∏ï‡∏±‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏ô‡∏≥", "‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏", "‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô"], a: 0 }, 
            { t: "‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡∏°‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î ‡∏Ñ‡∏∑‡∏≠", opts: ["‡πÇ‡∏ß‡∏•‡∏ï‡πå", "‡πÇ‡∏≠‡∏´‡πå‡∏°", "‡∏ü‡∏≤‡∏£‡∏±‡∏î", "‡πÅ‡∏≠‡∏°‡πÅ‡∏õ‡∏£‡πå"], a: 2 }, 
            { t: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå‡∏ï‡∏±‡∏ß‡πÉ‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö‡∏ß‡∏≤‡∏•‡πå‡∏ß‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤", opts: ["‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏", "‡∏ï‡∏±‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏ô‡∏≥", "‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô", "‡∏ï‡∏±‡∏ß‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå"], a: 3 }, 
            { t: "‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏∂‡∏á‡∏ñ‡∏∂‡∏á‡∏Ç‡∏±‡πâ‡∏ß‡∏ö‡∏ß‡∏Å ‡∏•‡∏ö ‡πÄ‡∏™‡∏°‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏•‡∏á‡∏ö‡∏ô ‡πÅ‡∏ú‡πà‡∏ô Board", opts: ["‡∏ä‡∏ô‡∏¥‡∏î‡πÄ‡∏ã‡∏£‡∏≤‡∏°‡∏¥‡∏Å", "‡∏ä‡∏ô‡∏¥‡∏î‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©", "‡∏ä‡∏ô‡∏¥‡∏î‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡πÇ‡∏ó‡∏£‡∏•‡∏¥‡∏ï‡∏¥‡∏Å", "‡πÅ‡∏ß‡∏£‡∏¥‡πÄ‡∏≠‡πÄ‡∏ö‡∏¥‡∏•"], a: 2 }, 
            { t: "‡∏ï‡∏±‡∏ß‡πÑ‡∏î‡πÇ‡∏≠‡∏î‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà ‡∏Ñ‡∏∑‡∏≠", opts: ["‡∏Ç‡∏¢‡∏≤‡∏¢‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì", "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•", "‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå", "‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÇ‡∏î‡∏¢‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß"], a: 3 }, 
            { t: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏≤‡∏£‡∏Å‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏ô‡∏≥", opts: ["Diode,Resistor", "LED,Inductor", "Capacitor, Resistor", "Diode, IC"], a: 2 }, 
            { t: "‡∏ï‡∏±‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏ô‡∏≥‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏¢‡πà‡∏≠‡πÉ‡∏ô Build sheet (B/S) ‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£", opts: ["L", "T", "D", "R"], a: 0 }, 
            { t: "‡∏ï‡∏±‡∏ß‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏¢‡∏≤‡∏¢‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏ì‡∏∞‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Å‡πá‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ß‡∏¥‡∏ó‡∏ã‡πå‡πÑ‡∏î‡πâ ‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏¢‡πà‡∏≠‡πÉ‡∏ô Build sheet (B/S) ‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£", opts: ["SW", "D, DR", "T, Q", "I.C, U"], a: 2 }, 
            { t: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡∏á‡∏ß‡∏á‡∏à‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏ú‡πà‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå‡∏•‡∏≤‡∏¢‡∏ß‡∏á‡∏à‡∏£", opts: ["PCB", "Board", "Substrate", "‡∏ñ‡∏π‡∏Å‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠"], a: 0 }, 
            { t: "‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (Comp.)‡∏ä‡∏ô‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡∏±‡πâ‡∏ß‡πÇ‡∏•‡∏´‡∏∞ (Terminal) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏á‡∏¢‡∏∂‡∏î‡∏ï‡∏¥‡∏î‡∏ö‡∏ô‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤ PCB ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡πÉ‡∏î", opts: ["COB", "PTH", "SMD", "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ñ‡∏π‡∏Å"], a: 2 }, 
            { t: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏™‡∏á‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á", opts: ["LED (‡πÅ‡∏≠‡∏• ‡∏≠‡∏µ ‡∏î‡∏µ)", "Transistor (‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Resistor (‡∏£‡∏µ‡∏ã‡∏µ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Capacitor (‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)"], a: 0 }, 
            { t: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏î ‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡∏•‡∏ß‡∏î‡∏ó‡∏≠‡∏á‡πÅ‡∏î‡∏á‡∏°‡∏≤‡∏û‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡πÜ ‡∏£‡∏≠‡∏ö ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏Ç‡∏≠‡∏á‡∏™‡∏ô‡∏≤‡∏°‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏•‡πá‡∏Å", opts: ["Resistor (‡∏£‡∏µ‡∏ã‡∏µ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Capacitor (‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Inductor (‡∏≠‡∏¥‡∏ô‡∏î‡∏±‡∏Ñ‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Transistor (‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)"], a: 2 }, 
            { t: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡πÉ‡∏î ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÄ‡∏™‡∏µ‡∏¢‡∏á ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏õ‡πâ‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤", opts: ["Inductor (‡∏≠‡∏¥‡∏ô‡∏î‡∏±‡∏Ñ‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Capacitor (‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Buzzer (‡∏ö‡∏±‡∏ä‡πÄ‡∏ã‡∏≠‡∏£‡πå)", "Transistor (‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)"], a: 2 }, 
            { t: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß‡πÅ‡∏ú‡∏á‡∏ß‡∏á‡∏à‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏î‡∏Å‡∏£‡∏µ ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£", opts: ["Component (‡∏Ñ‡∏≠‡∏°‡πÇ‡∏û‡πÄ‡∏ô‡πâ‡∏ô‡∏ó‡πå)", "Solder Resist (‡πÇ‡∏ã‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå ‡∏£‡∏µ‡∏ã‡∏µ‡∏™)", "Terminal (‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏ô‡∏≠‡∏•)", "Pad, Land (‡πÅ‡∏û‡∏î, ‡πÅ‡∏•‡∏ô‡∏î‡πå)"], a: 3 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/A.jpg", opts: ["Inductor (‡∏ä‡∏¥‡∏ö ‡∏≠‡∏¥‡∏ô‡∏î‡∏±‡∏Ñ‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Resistor (‡∏£‡∏µ‡∏ã‡∏µ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Capacitor (‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Diode (‡∏ã‡∏µ‡πÄ‡∏ô‡∏≠‡∏£‡πå ‡πÑ‡∏î‡πÇ‡∏≠‡∏î)"], a: 0 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/B.jpg", opts: ["Connector (‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ô‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Integrate Circuit (‡∏≠‡∏¥‡∏ô‡∏î‡∏¥‡πÄ‡∏Å‡∏£‡∏ó‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Å‡∏¥‡∏ï)", "Switch (‡∏™‡∏ß‡∏¥‡∏ó‡∏ã‡πå) ", "Transistor (‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)"], a: 1 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/C.jpg", opts: ["LED (‡∏´‡∏•‡∏≠‡∏î‡πÄ‡∏≠‡∏•‡∏≠‡∏µ‡∏î‡∏µ)", "Zener Diode  (‡∏ã‡∏µ‡πÄ‡∏ô‡∏≠‡∏£‡πå ‡πÑ‡∏î‡πÇ‡∏≠‡∏î)", "Crystal (‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡∏≠‡∏•)", "Buzzer (‡∏ö‡∏±‡∏ä‡πÄ‡∏ã‡∏≠‡∏£‡πå)"], a: 1 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/D.jpg", opts: ["Heatsink (‡∏Æ‡∏µ‡∏ó ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå)", "Transformer (‡∏ó‡∏£‡∏≤‡∏ô‡∏ü‡∏≠‡πÄ‡∏°‡∏≠‡∏£‡πå)", "Buzzer (‡∏ö‡∏±‡∏ä‡πÄ‡∏ã‡∏≠‡∏£‡πå)", "Switch (‡∏™‡∏ß‡∏¥‡∏ó‡∏ã‡πå)"], a: 2 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/E.jpg", opts: ["Electrolytic Capacitor (‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Ñ‡πÇ‡∏ó‡∏£‡πÑ‡∏•‡∏ï‡∏¥‡∏Å‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Ceramic Capacitor (‡πÄ‡∏ã‡∏£‡∏≤‡∏°‡∏¥‡∏Å‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Tantalum Capacitor (‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏•‡∏±‡∏° ‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Resistor (‡∏£‡∏µ‡∏ã‡∏µ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)"], a: 0 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/F.jpg", opts: ["Chip Resistor (‡∏ä‡∏¥‡∏ö ‡∏£‡∏µ‡∏ã‡∏µ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Chip Capacitor (‡∏ä‡∏¥‡∏ö ‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Inductor (‡∏ä‡∏¥‡∏ö ‡∏≠‡∏¥‡∏ô‡∏î‡∏±‡∏Ñ‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Diode (‡∏ã‡∏µ‡πÄ‡∏ô‡∏≠‡∏£‡πå ‡πÑ‡∏î‡πÇ‡∏≠‡∏î)"], a: 0 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/G.jpg", opts: ["Connector (‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ô‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Heat Sink (‡∏Æ‡∏µ‡∏ó ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå)", "Transformer (‡∏ó‡∏£‡∏≤‡∏ô‡∏ü‡∏≠‡πÄ‡∏°‡∏≠‡∏£‡πå)", "Crystal (‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡∏≠‡∏•)"], a: 1 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/H.jpg", opts: ["Resistor (‡∏£‡∏µ‡∏ã‡∏µ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Capacitor (‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Crystal (‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡∏≠‡∏•)", "LED (‡∏´‡∏•‡∏≠‡∏î‡πÄ‡∏≠‡∏•‡∏≠‡∏µ‡∏î‡∏µ)"], a: 2 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/I.jpg", opts: ["Chip Capacitor (‡∏ä‡∏¥‡∏ö ‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Chip Resistor (‡∏ä‡∏¥‡∏ö ‡∏£‡∏µ‡∏ã‡∏µ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Tantalum Capacitor (‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏•‡∏±‡∏° ‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Inductor (‡∏ä‡∏¥‡∏ö ‡∏≠‡∏¥‡∏ô‡∏î‡∏±‡∏Ñ‡πÄ‡∏ï‡∏≠‡∏£‡πå)"], a: 0 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/J.jpg", opts: ["Switch (‡∏™‡∏ß‡∏¥‡∏ó‡∏ã‡πå)", "Transformer (‡∏ó‡∏£‡∏≤‡∏ô‡∏ü‡∏≠‡πÄ‡∏°‡∏≠‡∏£‡πå)", "Buzzer (‡∏ö‡∏±‡∏ä‡πÄ‡∏ã‡∏≠‡∏£‡πå)", "Connector (‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ô‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå)"], a: 1 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/K.jpg", opts: ["Electrolytic Capacitor", "Tantalum Capacitor (‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏•‡∏±‡∏° ‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏ã‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Ceramic Capacitor", "Resistor"], a: 1 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/L.jpg", opts: ["Switch (‡∏™‡∏ß‡∏¥‡∏ó‡∏ã‡πå)", "Connector (‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ô‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Socket (‡∏ã‡πá‡∏≠‡∏Å‡πÄ‡∏Å‡πá‡∏ï)", "Terminal (‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏ô‡∏≠‡∏•)"], a: 0 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/M.jpg", opts: ["Diode", "Transistor (‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "IC", "Regulator"], a: 1 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/N.jpg", opts: ["Switch (‡∏™‡∏ß‡∏¥‡∏ó‡∏ã‡πå)", "Connector (‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ô‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Header  (‡πÄ‡∏Æ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå)", "Pin (‡∏û‡∏¥‡∏ô)"], a: 1 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/O.jpg", opts: ["Resistor (‡∏£‡∏µ‡∏ã‡∏µ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Diode (‡πÑ‡∏î‡πÇ‡∏≠‡∏î)", "Inductor (‡∏ä‡∏¥‡∏ö ‡∏≠‡∏¥‡∏ô‡∏î‡∏±‡∏Ñ‡πÄ‡∏ï‡∏≠‡∏£‡πå)", "Fuse (‡∏ü‡∏¥‡∏ß‡∏™‡πå)"], a: 0 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/P.jpg", opts: ["light (‡πÑ‡∏•‡∏ó‡πå)", "Neon (‡∏ô‡∏µ‡∏≠‡∏≠‡∏ô)", "LED (‡∏´‡∏•‡∏≠‡∏î‡πÄ‡∏≠‡∏•‡∏≠‡∏µ‡∏î‡∏µ)", "Display (‡∏î‡∏µ‡∏™‡πÄ‡∏û‡∏•‡∏¢‡πå)"], a: 2 }, 
            { t: "‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î?", img: "images/Q.jpg", opts: ["PCB (‡∏û‡∏µ‡∏ã‡∏µ‡∏ö‡∏µ)", "Wafer (‡πÄ‡∏ß‡πÄ‡∏ü‡∏≠‡∏£‡πå)", "Panel (‡∏û‡∏≤‡πÄ‡∏ô‡∏•)", "Sheet (‡∏ã‡∏µ‡∏™)"], a: 0 }, 
        ];

        let db, auth, currentStudent = null, studentCache = null, allResults = [], showAnswers = false, showNames = true;
        let configRef, studentsRef, studentQuestions = [], studentAnswersMap = {}, currentQIndex = 0;
        let studentOptionOrders = {}, currentDetailQuestionIndex = 0, showDetailResults = false;

        function updateLog(msg) { const el = document.getElementById('loading-log'); if(el) el.textContent = msg; }

        async function init() {
            try {
                updateLog("‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö...");
                const app = initializeApp(firebaseConfig);
                db = initializeFirestore(app, { experimentalForceLongPolling: true });
                auth = getAuth(app);
                configRef = doc(db, 'bec_config_v11', 'main'); 
                studentsRef = collection(db, 'bec_students_v11');

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        updateLog("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
                        setTimeout(() => { document.getElementById('loading-overlay').style.display = 'none'; }, 500);
                    } else {
                        signInAnonymously(auth).catch(e => {
                            document.getElementById('error-box').classList.remove('hidden');
                            document.getElementById('diagnostic-text').innerText = e.code + ": " + e.message;
                        });
                    }
                });
            } catch(e) { console.error(e); }
        }

        const show = (id) => {
            document.querySelectorAll('.page').forEach(el => el.style.display = 'none');
            document.getElementById(id).style.display = 'block';
            if(id === 'page-student-exam' || id === 'page-home' || id === 'page-question-detail') document.getElementById(id).style.display = 'flex';
        };

        // --- TEACHER SYSTEM ---
        document.getElementById('btn-go-teacher').onclick = () => show('page-teacher-login');
        document.getElementById('btn-go-student').onclick = () => show('page-student-login');

        document.getElementById('btn-teacher-login').onclick = () => {
            if(document.getElementById('teacher-room-code').value === TEACHER_CODE) {
                show('page-teacher-dashboard'); initTeacherDashboard();
            } else alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î");
        };
        document.getElementById('btn-back-dashboard').onclick = () => { show('page-teacher-dashboard'); showDetailResults = false; };

        function initTeacherDashboard() {
            const thead = document.querySelector('thead #grid-header-row');
            thead.innerHTML = `<th class="p-3 border-b w-12 text-center bg-slate-50 sticky left-0 z-20">#</th><th class="p-3 border-b w-24 text-center bg-slate-50 sticky left-12 z-20">‡∏£‡∏´‡∏±‡∏™</th><th class="p-3 border-b min-w-[200px] bg-slate-50 sticky left-[144px] z-20">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th><th class="p-3 border-b w-20 text-center bg-slate-50">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th class="p-3 border-b w-16 text-center bg-slate-50 text-sky-700 font-bold">%</th>`;
            MASTER_QUESTIONS.forEach((_, i) => {
                const th = document.createElement('th');
                th.className = "p-2 border-b text-center w-10 font-bold text-slate-400 text-xs clickable-header";
                th.innerText = i + 1; th.onclick = () => openQuestionDetail(i); thead.appendChild(th);
            });

            onSnapshot(configRef, (snap) => {
                const isOpen = snap.exists() ? snap.data().isOpen : false;
                const btn = document.getElementById('btn-toggle-system');
                btn.innerHTML = isOpen ? `<i class="fa-solid fa-pause"></i> ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö` : `<i class="fa-solid fa-play"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö`;
                btn.className = isOpen ? "px-6 py-2.5 rounded-xl text-white font-bold shadow-md bg-amber-500 hover:bg-amber-600 flex items-center gap-2" : "px-6 py-2.5 rounded-xl text-white font-bold shadow-md bg-emerald-500 hover:bg-emerald-600 flex items-center gap-2";
                btn.onclick = async () => await setDoc(configRef, { isOpen: !isOpen });
            });

            onSnapshot(query(studentsRef), (snap) => {
                allResults = []; snap.forEach(d => allResults.push(d.data()));
                renderGrid(); updateLeaderboard();
                if(document.getElementById('page-question-detail').style.display === 'flex') renderQuestionDetail();
            });
            document.getElementById('toggle-answers').onchange = () => renderGrid();
            document.getElementById('toggle-names').onchange = () => renderGrid();
        }

        function openQuestionDetail(index) {
            currentDetailQuestionIndex = index; showDetailResults = false;
            show('page-question-detail'); renderQuestionDetail();
        }
        
        function renderQuestionDetail() {
            const q = MASTER_QUESTIONS[currentDetailQuestionIndex];
            document.getElementById('detail-q-num').innerText = currentDetailQuestionIndex + 1;
            document.getElementById('detail-q-text').innerText = q.t;
            const imgTag = document.getElementById('detail-img-tag');
            if(q.img) {
                imgTag.parentElement.classList.remove('hidden'); imgTag.src = q.img;
            } else imgTag.parentElement.classList.add('hidden');
            
            let counts = [0, 0, 0, 0], totalAnswered = 0, correctCount = 0;
            allResults.forEach(s => {
                if (!s.answers) return;
                const ansIdx = s.answers[currentDetailQuestionIndex];
                if(ansIdx !== null && ansIdx !== undefined) {
                    counts[ansIdx]++; totalAnswered++; if(ansIdx === q.a) correctCount++;
                }
            });
            document.getElementById('detail-total-responses').innerText = totalAnswered;
            const btnToggle = document.getElementById('btn-toggle-detail-results');
            const resultsContainer = document.getElementById('detail-results-container');
            resultsContainer.innerHTML = ''; 

            if (showDetailResults) {
                btnToggle.innerHTML = `<i class="fa-solid fa-eye-slash"></i> ‡∏ã‡πà‡∏≠‡∏ô‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå`;
                resultsContainer.classList.remove('opacity-50', 'blur-sm', 'pointer-events-none');
                document.getElementById('detail-correct-count').innerText = correctCount;
                q.opts.forEach((optText, i) => {
                    const isCorrect = (i === q.a); const count = counts[i]; const pct = totalAnswered > 0 ? Math.round((count / totalAnswered) * 100) : 0;
                    resultsContainer.innerHTML += `
                    <div class="relative p-3 rounded-xl border ${isCorrect ? 'bg-green-50 border-green-200' : 'bg-white border-slate-100'}">
                        <div class="flex items-center justify-between mb-2 relative z-10 text-sm font-bold">
                            <div class="flex items-center gap-2">
                                <div class="w-6 h-6 rounded-full ${isCorrect ? 'bg-green-500 text-white' : 'bg-slate-100 text-slate-400'} flex items-center justify-center text-[10px]">${isCorrect ? '‚úì' : String.fromCharCode(65+i)}</div>
                                <span class="${isCorrect ? 'text-green-700' : 'text-slate-700'}">${optText}</span>
                            </div>
                            <span>${pct}% (${count})</span>
                        </div>
                        <div class="w-full bg-slate-100 rounded-full h-1.5 overflow-hidden"><div class="bar-fill ${isCorrect ? 'bg-green-500' : 'bg-red-400'} h-full" style="width: ${pct}%"></div></div>
                    </div>`;
                });
            } else {
                btnToggle.innerHTML = `<i class="fa-solid fa-chart-simple"></i> ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå`;
                resultsContainer.classList.add('opacity-50', 'blur-sm', 'pointer-events-none');
                document.getElementById('detail-correct-count').innerText = correctCount; // Socrative shows correct count even before bars
                q.opts.forEach((optText, i) => {
                    resultsContainer.innerHTML += `<div class="p-3 rounded-xl border bg-slate-50 border-slate-100 flex items-center gap-3 text-sm"><div class="w-6 h-6 rounded-full bg-white border text-slate-300 flex items-center justify-center text-[10px] font-bold">${String.fromCharCode(65+i)}</div><span class="font-medium text-slate-400">${optText}</span></div>`;
                });
            }
        }

        document.getElementById('btn-toggle-detail-results').onclick = () => { showDetailResults = !showDetailResults; renderQuestionDetail(); };
        document.getElementById('btn-prev-q').onclick = () => { if(currentDetailQuestionIndex > 0) { currentDetailQuestionIndex--; showDetailResults = false; renderQuestionDetail(); }};
        document.getElementById('btn-next-q').onclick = () => { if(currentDetailQuestionIndex < 39) { currentDetailQuestionIndex++; showDetailResults = false; renderQuestionDetail(); }};

        function renderGrid() {
            const showNames = document.getElementById('toggle-names').checked;
            const showAnswers = document.getElementById('toggle-answers').checked;
            const tbody = document.getElementById('grid-body'); tbody.innerHTML = '';
            document.getElementById('student-count').innerText = allResults.length;
            allResults.sort((a,b) => (b.status === 'submitted' ? 1 : 0) - (a.status === 'submitted' ? 1 : 0));
            allResults.forEach((s, i) => {
                const tr = document.createElement('tr'); tr.className = "hover:bg-slate-50 transition border-b border-slate-50";
                tr.innerHTML += `<td class="p-3 text-center text-slate-400 text-xs sticky left-0 bg-white group-hover:bg-slate-50 z-10">${i+1}</td><td class="p-3 text-center text-slate-600 font-mono text-xs sticky left-12 bg-white group-hover:bg-slate-50 z-10">${s.studentId}</td><td class="p-3 whitespace-nowrap sticky left-[144px] bg-white group-hover:bg-slate-50 z-10 border-r border-slate-100"><div class="text-slate-700 font-medium text-sm">${showNames ? s.name : '***'}</div><div class="text-xs text-slate-400">${s.dept}</div></td>`;
                tr.innerHTML += `<td class="p-3 text-center">${s.status === 'submitted' ? '<span class="px-2 py-0.5 rounded-md bg-emerald-100 text-emerald-700 text-xs font-bold">‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß</span>' : '<span class="px-2 py-0.5 rounded-md bg-sky-100 text-sky-700 text-xs font-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥</span>'}</td>`;
                tr.innerHTML += `<td class="p-3 text-center font-bold text-slate-700 text-sm">${s.score !== null ? s.score.toFixed(0)+'%' : '-'}</td>`;
                s.answers.forEach((ansIdx, idx) => {
                    let cls = "w-6 h-6 rounded-md mx-auto flex items-center justify-center text-[10px] font-bold ";
                    let txt = (ansIdx === null) ? "‚Ä¢" : "";
                    if (ansIdx !== null) { 
                        if(showAnswers) { 
                            const isC = (ansIdx === MASTER_QUESTIONS[idx].a); 
                            cls += isC ? "bg-emerald-500 text-white" : "bg-red-500 text-white"; 
                            txt = isC ? "‚úì" : "‚úï"; 
                        } else cls += "bg-sky-500 text-white"; 
                    } else cls += "bg-slate-100 text-slate-300";
                    tr.innerHTML += `<td class="p-1"><div class="${cls}">${txt}</div></td>`;
                });
                tbody.appendChild(tr);
            });
        }

        function updateLeaderboard() {
            const ranked = allResults.filter(s => s.status === 'submitted').sort((a,b) => b.score - a.score || a.timeTaken - b.timeTaken).slice(0, 5);
            const div = document.getElementById('leaderboard-list'); div.innerHTML = '';
            if(!ranked.length) { div.innerHTML = '<div class="text-center opacity-70 py-4 col-span-5 text-sm">‡∏£‡∏≠‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô...</div>'; return; }
            ranked.forEach((s, i) => {
                const colors = ["from-yellow-400 to-yellow-600", "from-slate-300 to-slate-400", "from-amber-600 to-amber-700", "from-blue-400 to-blue-500", "from-blue-400 to-blue-500"];
                const icons = ["ü•á", "ü•à", "ü•â", "4", "5"];
                div.innerHTML += `
                    <div class="bg-white/10 p-3 rounded-xl backdrop-blur-md flex flex-col items-center border border-white/10">
                        <div class="w-8 h-8 rounded-full bg-gradient-to-br ${colors[i]} flex items-center justify-center text-sm font-bold mb-2 shadow-lg">${icons[i]}</div>
                        <div class="text-xs font-bold truncate w-full text-center mb-1">${s.name}</div>
                        <div class="text-lg font-black text-yellow-300">${s.score.toFixed(0)}%</div>
                    </div>`;
            });
        }

        // --- STUDENT SYSTEM ---
        async function fetchStudents() { if(studentCache) return studentCache; const res = await fetch(SHEET_URL); const csv = await res.text(); return new Promise(r => Papa.parse(csv, {header:true, skipEmptyLines:true, complete: res=>r(res.data)})); }
        document.getElementById('student-id').addEventListener('input', async (e) => { const id = e.target.value.trim(); if(id.length < 3) return; const list = await fetchStudents(); const s = list.find(x => x['‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß'] == id); if(s) { document.getElementById('preview-name').innerText = s['‡∏ä‡∏∑‡πà‡∏≠'] + " " + s['‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•']; document.getElementById('preview-dept').innerText = s['‡πÅ‡∏ú‡∏ô‡∏Å']; document.getElementById('student-preview').classList.remove('hidden'); studentCache = list; } else document.getElementById('student-preview').classList.add('hidden'); });

        document.getElementById('btn-student-login').onclick = async () => {
            const id = document.getElementById('student-id').value.trim();
            const conf = await getDoc(configRef); if(!conf.exists() || !conf.data().isOpen) return alert("‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î");
            const list = await fetchStudents(); const s = list.find(x => x['‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß'] == id); if(!s) return alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
            currentStudent = { id: s['‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß'], name: s['‡∏ä‡∏∑‡πà‡∏≠']+" "+s['‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•'], dept: s['‡πÅ‡∏ú‡∏ô‡∏Å'], startTime: Date.now() };
            const existing = await getDoc(doc(studentsRef, currentStudent.id));
            if(existing.exists() && existing.data().status === 'submitted') return alert("‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß");
            if(!existing.exists()) { await setDoc(doc(studentsRef, currentStudent.id), { studentId: currentStudent.id, name: currentStudent.name, dept: currentStudent.dept, status: 'online', score: null, answers: new Array(40).fill(null) }); setupRandomQuestions(); }
            else { setupRandomQuestions(); const saved = existing.data().answers; studentQuestions.forEach(q => { if(saved[q.originalIndex] !== null) studentAnswersMap[q.originalIndex] = saved[q.originalIndex]; }); }
            document.getElementById('exam-student-name').innerText = currentStudent.name; document.getElementById('exam-student-dept').innerText = currentStudent.dept;
            renderQuestion(); show('page-student-exam');
        };

        function setupRandomQuestions() {
            let qs = MASTER_QUESTIONS.map((q, i) => ({ ...q, originalIndex: i }));
            const storageKey = `rba_order_${currentStudent.id}`; const orderKey = `rba_opts_order_${currentStudent.id}`;
            const savedOrder = localStorage.getItem(storageKey); const savedOpts = localStorage.getItem(orderKey);
            if(savedOrder && JSON.parse(savedOrder).length === 40) { studentQuestions = JSON.parse(savedOrder).map(i => qs[i]); studentOptionOrders = JSON.parse(savedOpts); }
            else { for (let i = 39; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [qs[i], qs[j]] = [qs[j], qs[i]]; } studentQuestions = qs; studentOptionOrders = {}; studentQuestions.forEach(q => { let opts = [0, 1, 2, 3]; for (let i = 3; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [opts[i], opts[j]] = [opts[j], opts[i]]; } studentOptionOrders[q.originalIndex] = opts; }); localStorage.setItem(storageKey, JSON.stringify(studentQuestions.map(q => q.originalIndex))); localStorage.setItem(orderKey, JSON.stringify(studentOptionOrders)); }
            currentQIndex = 0;
        }

        function renderQuestion() {
            const q = studentQuestions[currentQIndex]; document.getElementById('q-current').innerText = currentQIndex + 1; document.getElementById('question-text').innerText = q.t;
            const imgContainer = document.getElementById('question-image-container'); if(q.img) { imgContainer.classList.remove('hidden'); document.getElementById('question-image').src = q.img; } else imgContainer.classList.add('hidden');
            document.getElementById('progress-bar').style.width = `${((currentQIndex) / 40) * 100}%`;
            document.getElementById('btn-prev').disabled = currentQIndex === 0; document.getElementById('btn-next').classList.toggle('hidden', currentQIndex === 39); document.getElementById('btn-submit').classList.toggle('hidden', currentQIndex !== 39);
            const optsContainer = document.getElementById('options-container'); optsContainer.innerHTML = '';
            studentOptionOrders[q.originalIndex].forEach((origIdx, i) => { const isS = studentAnswersMap[q.originalIndex] === origIdx; optsContainer.innerHTML += `<div onclick="selectAnswer(${origIdx})" class="flex items-center p-4 border-2 rounded-xl cursor-pointer transition-all group ${isS ? 'border-sky-500 bg-sky-50 ring-2 ring-sky-200' : 'border-slate-100 hover:bg-slate-50'}"><div class="w-8 h-8 rounded-full border-2 flex items-center justify-center mr-4 ${isS ? 'bg-sky-500 border-sky-500 text-white' : 'border-slate-300 bg-white group-hover:border-sky-400'}">${isS ? '‚úì' : String.fromCharCode(65 + i)}</div><span class="text-lg font-medium text-slate-700">${q.opts[origIdx]}</span></div>`; });
        }

        window.selectAnswer = async (val) => { const q = studentQuestions[currentQIndex]; studentAnswersMap[q.originalIndex] = val; renderQuestion(); const masterArray = new Array(40).fill(null); for(let i=0; i<40; i++) { if(studentAnswersMap[i] !== undefined) masterArray[i] = studentAnswersMap[i]; } await updateDoc(doc(studentsRef, currentStudent.id), { answers: masterArray }); };
        document.getElementById('btn-prev').onclick = () => { if(currentQIndex > 0) { currentQIndex--; renderQuestion(); }};
        document.getElementById('btn-next').onclick = () => { if(studentAnswersMap[studentQuestions[currentQIndex].originalIndex] === undefined) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö"); currentQIndex++; renderQuestion(); };
        
        document.getElementById('btn-submit').onclick = async () => {
            if(studentAnswersMap[studentQuestions[currentQIndex].originalIndex] === undefined) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢");
            if(!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö?")) return;
            let score = 0; MASTER_QUESTIONS.forEach((q, i) => { if(studentAnswersMap[i] === q.a) score++; });
            const finalScore = (score / 40) * 100;
            const masterArray = new Array(40).fill(null); for(let i=0; i<40; i++) { if(studentAnswersMap[i] !== undefined) masterArray[i] = studentAnswersMap[i]; }
            await updateDoc(doc(studentsRef, currentStudent.id), { answers: masterArray, score: finalScore, status: 'submitted', timeTaken: (Date.now() - currentStudent.startTime)/1000 });
            
            // Celebration logic
            if(finalScore === 100) {
                document.getElementById('submit-emoji').innerText = "üèÜ";
                document.getElementById('submit-title').innerText = "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏° 100";
                document.getElementById('submit-title').classList.add('text-transparent', 'bg-clip-text', 'bg-gradient-to-r', 'from-yellow-400', 'to-orange-600');
                document.getElementById('submit-message').innerText = "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡∏°‡∏≤‡∏Å! ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏î‡πâ‡∏≤‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå";
                startCelebration();
            }
            show('page-submitted');
        };

        function startCelebration() {
            const container = document.getElementById('confetti-container');
            const colors = ['#f43f5e', '#3b82f6', '#10b981', '#fbbf24', '#8b5cf6', '#ec4899'];
            const emojis = ['üå∏', '‚ú®', '‚≠ê', 'üéà', 'üéâ', 'üåª', 'üíÆ'];
            
            for (let i = 0; i < 100; i++) {
                const el = document.createElement('div');
                el.className = 'confetti';
                if(Math.random() > 0.5) {
                    el.innerText = emojis[Math.floor(Math.random() * emojis.length)];
                    el.style.fontSize = (Math.random() * 20 + 10) + 'px';
                    el.style.background = 'transparent';
                } else {
                    el.style.background = colors[Math.floor(Math.random() * colors.length)];
                }
                
                el.style.left = Math.random() * 100 + 'vw';
                el.style.animation = `confettiFall ${Math.random() * 3 + 2}s linear forwards`;
                el.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(el);
                
                // cleanup
                setTimeout(() => el.remove(), 5000);
            }
        }

        document.getElementById('btn-dl-excel').onclick = () => {
            const data = allResults.map((s, i) => { const row = { "‡∏•‡∏≥‡∏î‡∏±‡∏ö": i+1, "‡∏£‡∏´‡∏±‡∏™": s.studentId, "‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•": s.name, "‡πÅ‡∏ú‡∏ô‡∏Å": s.dept, "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô(%)": s.score || 0 }; s.answers.forEach((ans, idx) => { row[`‡∏Ç‡πâ‡∏≠ ${idx+1}`] = (ans === MASTER_QUESTIONS[idx].a) ? "‡∏ñ‡∏π‡∏Å" : (ans === null ? "‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö" : "‡∏ú‡∏¥‡∏î"); }); return row; });
            const ws = XLSX.utils.json_to_sheet(data); const wb = XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb, ws, "Results"); XLSX.writeFile(wb, "Electronics_Exam_Results.xlsx");
        };

        document.getElementById('btn-clear-db').onclick = async () => { if(confirm("‚ö†Ô∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) { const snap = await getDocs(studentsRef); const batch = writeBatch(db); snap.forEach(d => batch.delete(d.ref)); await batch.commit(); alert("‡∏•‡πâ‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"); } };

        init();
    </script>
</body>
</html>